# 用户与组管理相关命令

## 一、Linux系统中用户和权限

### 1.1 三种类型用户

1. 文件拥护者（user）
2. 同组用户（group）
3. 其他用户（others）

### 1.2 三种文件权限

1. 可读文件 (r)
2. 可写文件 (w)
3. 可执行文文件 (x)

### 1.3 ls -la 查看文件详细信息

```shell
$ ls -la
total 5   #文件总数 包含以'.'开头的隐藏文件
drwxr-xr-x 25 mygit mygit 4096 Apr  9 19:57 .
drwxr-xr-x 31 mygit mygit 4096 Apr 24 17:11 ..
-rwxrwxr-x  1 mygit mygit 8296 Apr  9 15:04 a.out
drwxr-xr-x  3 mygit mygit 4096 Apr  2 20:49 auto_complete
drwxr-xr-x  3 mygit mygit 4096 Apr  2 20:49 cmdline_mode
```

以空格作为分界符，上面每条信息共包含9个子段，接下来分别介绍，以auto_complete的相关信息为例：drwxr-xr-x  3 mygit mygit 4096 Apr  2 20:49 auto_complete

1. 第1个字段drwxr-xr-x，共包含10个字符

   第1个字符d，表示文件类型，常见的有7种文件类型：

   * d：目录
   * -: 普通文件
   * l ：连接文件
   * b：块设备文件
   * c：字符设备文件
   * p：管道文件
   * s：套接字文件

   后面9个字符，每3个分为1组，分别代表读(r)，写(w)，执行权限(x)，分为3组，对应3种用户

   r: 具有读权限   w: 具有写权限  x:  具有执行权限  -: 无权限

   * 第1组 所属用户权限
   * 第2组 所属组权限
   * 第3组 其他用户权限

2. 第2个字段 3

   若为目录：目录中所含文件数目

   若为文件：硬连接数

   * 硬连接：在Linux所有文件都指向一个索引节点，让一个文件指向1个已存在的文件，则该连接称为硬连接。多个文件可以指向同一个索引节点，更改其中一个文件，所有文件都随之改变，用ln 命令建立一个文件的硬连接。

     用法：ln 源文件 目标文件

   * 软连接：类似windows的快捷方式，它只包含目标文件的路径信息，可以修改该文件。删除软连接不影响原文件。

     用法：ln -s 源文件 目标文件

3. 后面7个字段依次表示：

   * 文件所属用户
   * 文件所属组
   * 文件大小或文件名所占据的大小(针对目录通常为4096的整数倍，至少4096)
   * 修改日期
   * 文件名

## 二、chmod

### 2.1 用法及作用

作用：控制文件或目录的访问权限

用法：chmod [options] mode[,mode] file1 [file2 ...]

**常见options参数**

| 选项      | 说明                                             |
| --------- | ------------------------------------------------ |
| -c        | 若该文件权限与目录确实已经更改，才显示其更改动作 |
| -f        | 若该文件权限与目录无法被更改也不要显示错误讯息   |
| -v        | 显示权限变更的详细资料                           |
| -R        | 对当前目录下的所有文件与目录进行相同的权限变更   |
| --help    | 显示辅助说明                                     |
| --version | 显示版本                                         |



### 2.2 字符表示法

chmod [u g o a] [= + -] [r w x]   注意：字符间不加空格

| 字符     | 说明                 |
| -------- | -------------------- |
| a (all)  | 所有用户             |
| u(user)  | 文件所属用户         |
| g(group) | 文件所属组           |
| o(other) | 其它用户             |
| =        | 该用户将只有一种权限 |
| -        | 减去某种权限         |
| +        | 增加某种权限         |
| r        | 读权限               |
| w        | 写权限               |
| x        | 可执行权限           |

例如：

`chmod u-x,g-w,o+r t1.txt`  将t1.txt，将**所属用户**==减去==可执行权限，**所属组**==增加==读权限，**其他用户**==只有==读权限

`chmod u=x,g+r  t.txt`   将t.txt，**所属用户**==只有==执行权限，**所属组**增加读权限。

### 2.3 数字表示法

用1位八进制数，即 3 位二进制数表示 读 写 执行权限，1表示具有该权限，0表示没有该权限。例如：

* 1 1 1 表示 r w x，对应八进制 7
* 1 1 0 表示 r w -，对应八进制 6
* 1 0 1 表示 r - x ，对应八进制 5
* 依次类推。

其中，每种用户对应一个八进制，即用 3 个八进制数表示用户具有的权限。例如：

* 1 1 1 1 1 1 1 1 1表示 r w x r w x r w x，表示文件的所属用户，所属组，其他用户都具有该文件的读写执行权限，这也称为 Linux 最高权限。表示为 777
* 1 1 1 1 1 0 1 1 0，即766
* 1 1 0 1 1 0 1 0 0，即664

`chmod -R 777 test ` 递归赋予test及其子目录所有文件所有用户读写执行权限。

